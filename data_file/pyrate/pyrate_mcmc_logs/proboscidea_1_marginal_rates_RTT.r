# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/eeb-177-final-project/data_file/pyrate_mcmc_logs/proboscidea_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/eeb-177-final-project/data_file/pyrate_mcmc_logs/proboscidea_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.0872899358438, 0.0872899358438,0.0872899358438,0.0756878972715,0.0612916213779,0.0672546692682,0.0674724245002,0.0694767048315,0.0699145872549,0.0699145872549,0.0696719184861,0.0699145872549,0.0706522240761,0.070844586858,0.070844586858,0.0688065587809,0.064017930316,0.0696719184861,0.0735470251632,0.0755814290149,0.0797084932313,0.106749404034,0.123486594697,0.128051481048,0.127545244228,0.128703287966,0.12844808194,0.130319990717,0.131393735118,0.131393735118,0.131393735118,0.128703287966,0.128703287966,0.128346554498,0.128346554498,0.128051481048,0.127545244228,0.126777045702,0.118647732625,0.118988122442,0.117993491564,0.118988122442,0.132784396544,0.128955812531,0.133173884309,0.131147825025,0.128346554498,0.124458323228,0.133356806484,0.12875949342,0.130113657402,0.131147825025,0.131147825025,0.12875949342,0.12875949342,0.12875949342)
L_hpd_M95=c(0.252999334041, 0.252999334041,0.252999334041,0.243569158656,0.160529048139,0.143454297479,0.137486784189,0.137634756143,0.137486784189,0.137486784189,0.136631384592,0.136505897467,0.136631384592,0.137029168772,0.137486784189,0.137446307287,0.17955818034,0.211794303932,0.221912326593,0.246800244926,0.291616446889,0.306920074097,0.312289129656,0.311392206545,0.308398301402,0.307890179998,0.306920074097,0.307890179998,0.308100987059,0.307890179998,0.307890179998,0.306278717015,0.306278717015,0.306278717015,0.306433492064,0.307300964643,0.307890179998,0.312382093165,0.319287435444,0.402798720726,0.491108573027,0.509111299503,0.535533796133,0.535533796133,0.543505677184,0.543505677184,0.548291556364,0.565763015879,0.585539191605,0.598100670559,0.602715709179,0.60907590042,0.616258113604,0.618088856737,0.620328280926,0.621159700559)
M_hpd_m95=c(1.07845469472, 1.07845469472,0.058037180184,0.058037180184,0.0583409959974,0.0584305941537,0.0584305941537,0.0584305941537,0.0421227641313,0.0417690633021,0.0402133569923,0.018319561091,0.0128929076655,0.0115620330735,0.00983784144352,0.0115264001107,0.00983784144352,0.0103397368811,0.0103397368811,0.0103397368811,0.0103397368811,0.00886030526217,0.00807218417021,0.0281761935562,0.0349434650684,0.0418462428809,0.0419047207272,0.046494711064,0.046494711064,0.0968577995684,0.0994419123103,0.0960857992654,0.0945359106833,0.0817180802762,0.0723521409218,0.052005095781,0.0467103547638,0.0556831959372,0.0558032087435,0.0590123806329,0.0836970738672,0.0871094888515,0.0871094888515,0.088177585252,0.0817180802762,0.0827870372181,0.0820724190042,0.0871094888515,0.0827870372181,0.0820724190042,0.0827870372181,0.0820724190042,0.0871094888515,0.0820724190042,0.0827870372181,0.0827870372181)
M_hpd_M95=c(1.78166532705, 1.78166532705,0.135027758328,0.133394515969,0.133394515969,0.133394515969,0.133394515969,0.136322508882,0.128332014259,0.128332014259,0.127589502935,0.120283315098,0.101371939724,0.0894362815246,0.0793558349499,0.0793558349499,0.0777169697673,0.0783030332188,0.0783030332188,0.0783030332188,0.0783030332188,0.0820749137572,0.190476040393,0.232203740402,0.232965052775,0.238600392363,0.238444347451,0.2445118027,0.25155992124,0.264971306411,0.265683212512,0.256098505751,0.265683212512,0.271287959743,0.264841073599,0.249928971091,0.247187658772,0.259056612401,0.258095708336,0.259056612401,0.269670758719,0.267674257694,0.267674257694,0.26906379126,0.270947002157,0.282681193797,0.294020942109,0.335102283203,0.351353222668,0.395442042314,0.405168165535,0.415678238053,0.426783917183,0.441635146961,0.445388864629,0.445388864629)
R_hpd_m95=c(-1.60505286888, -1.60505286888,-0.0299287754378,-0.0411368403351,-0.0548984939782,-0.0493622901706,-0.0484466823149,-0.0496373523582,-0.0412868152768,-0.041273982701,-0.0411368403351,-0.029219676575,-0.0110496725558,-0.00266276523133,0.0111278327084,0.0111278327084,0.00866692951,0.0121207142966,0.00866692951,0.0123934392732,0.0218157597387,0.0682263572995,-0.00568834406054,-0.0421122502022,-0.0421122502022,-0.0464917135258,-0.0421122502022,-0.0420339131796,-0.0672921225291,-0.0709681211908,-0.0672921225291,-0.0609312488841,-0.0672921225291,-0.0700146777899,-0.0664977160887,-0.0664149244133,-0.0672921225291,-0.0563989018651,-0.0700146777899,-0.0822402279635,-0.092281756744,-0.0842700255718,-0.109092612097,-0.104172689791,-0.11959825704,-0.103000329269,-0.104172689791,-0.110619865225,-0.144470108874,-0.156657648893,-0.194616939443,-0.194616939443,-0.242789434967,-0.244713910166,-0.244713910166,-0.244713910166)
R_hpd_M95=c(-0.870427136177, -0.870427136177,0.170669989824,0.155512958392,0.0706987794409,0.0600166289313,0.0584353654346,0.058174391669,0.0700884028505,0.0712841475616,0.070549052085,0.101226439898,0.108556905733,0.112009185575,0.116467121306,0.115946455944,0.158725981633,0.184629749716,0.188141457162,0.216513200075,0.260604757155,0.290958597613,0.285692410115,0.23433435706,0.225556557151,0.219887338807,0.220530880981,0.219680859976,0.189710770903,0.173262884828,0.173531923145,0.173262884828,0.174275432643,0.185820434036,0.191184387732,0.194884585733,0.195255521701,0.212073060541,0.212073060541,0.262640830618,0.340246625366,0.386380077629,0.377239005614,0.388160051463,0.39707237967,0.42338711068,0.444291895586,0.486098539286,0.486098539286,0.549145278588,0.529628172206,0.546980847501,0.513454042792,0.535852427167,0.536153395748,0.536153395748)
L_mean=c(0.148072663609, 0.148072663609,0.147993035175,0.137167686149,0.111006267227,0.106592813329,0.105249615063,0.104827163493,0.104696680886,0.104657630535,0.104783238127,0.105066964704,0.10527929062,0.105663031616,0.105805636749,0.106385760388,0.112847531029,0.119955169531,0.122983418556,0.138637663975,0.188767724374,0.223500655353,0.230917870287,0.231860366709,0.231981629367,0.231764772466,0.231934496201,0.231593862428,0.231212869553,0.231254344748,0.230348327769,0.229218063925,0.22880127073,0.228377271331,0.227980401445,0.227801798386,0.228191751602,0.230490737663,0.234897040581,0.248600594744,0.268424397822,0.278379305895,0.282793959284,0.285374650738,0.286942199279,0.288091678968,0.29081450805,0.298535571897,0.30187808507,0.30727568311,0.30952236437,0.312077298271,0.314358303057,0.316028240423,0.316485793695,0.3163476715)
M_mean=c(1.39902554891, 1.39902554891,0.0965983910046,0.0962416481095,0.0960900657925,0.0960614560607,0.0959592883665,0.0950336133948,0.0906058361711,0.0896314185059,0.0890109331285,0.0715275124027,0.0515013219755,0.0442139703031,0.039519021111,0.038454165625,0.0381977015842,0.0381333398855,0.0381333398855,0.0381333398855,0.0381333398855,0.0407999533866,0.0717771363762,0.13934789123,0.143915973313,0.148702699582,0.153706271252,0.156953676281,0.165229329803,0.179651145211,0.177618982462,0.172837540598,0.167511982991,0.163529554501,0.162618439896,0.159935665034,0.158160863254,0.158603361428,0.159456620054,0.161528106071,0.166391458149,0.173479904997,0.175053511943,0.175220025939,0.177124313771,0.178348215219,0.18009113944,0.185478638866,0.190739916848,0.1975588252,0.19851979105,0.19985568236,0.201372313588,0.204593693296,0.204702482243,0.204702482243)
R_mean=c(-1.2509528853, -1.2509528853,0.0513946441704,0.0409260380393,0.0149162014343,0.0105313572684,0.00929032669619,0.00979355009776,0.0140908447149,0.0150262120294,0.0157723049989,0.033539452301,0.053777968645,0.0614490613133,0.0662866156384,0.0679315947633,0.0746498294447,0.0818218296459,0.0848500786706,0.10050432409,0.150634384488,0.182700701966,0.159140733911,0.0925124754786,0.0880656560549,0.0830620728837,0.0782282249495,0.0746401861468,0.0659835397502,0.0516031995366,0.0527293453074,0.056380523327,0.0612892877398,0.0648477168309,0.0653619615482,0.0678661333522,0.0700308883476,0.0718873762358,0.0754404205273,0.0870724886726,0.102032939673,0.104899400898,0.107740447341,0.110154624798,0.109817885509,0.10974346375,0.11072336861,0.113056933031,0.111138168222,0.10971685791,0.111002573321,0.112221615911,0.112985989469,0.111434547126,0.111783311452,0.111645189257)
trans=0.5
age=(0:(56-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.683275670615), xlim = c(-58.8,2.8), ylab = 'Speciation rate', xlab = 'Ma',main='proboscidea' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.95983185976), xlim = c(-58.8,2.8), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.76555815576, 0.604059806446), xlim = c(-58.8,2.8), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-58.8,2.8), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()