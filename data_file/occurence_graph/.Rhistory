proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage))+ theme(legend.position = "none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c(0, 40, 80, 120, 160, 200, 240, 280,320)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage))+ theme(legend.position = "none") +  coord_flip() +  theme(axis.text.y = element_text(size=6)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c(0, 40, 80, 120, 160, 200, 240, 280,320)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c(0, 10, 20, 30, 40, 50)) + labs(title = "Canid Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.x  = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c(0, 10, 20, 30, 40, 50)) + labs(title = "Canid Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y  = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c(0, 10, 20, 30, 40, 50)) + labs(title = "Canid Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage))  +  coord_flip() +  theme(axis.text.y  = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c(0, 10, 20, 30, 40, 50)) + labs(title = "Canid Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage)) +theme(legend.position="none")+ coord_flip() +  theme(axis.text.y  = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c(0, 10, 20, 30, 40, 50)) + labs(title = "Canid Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
library(forcats)
library(forcats)
proboscidea_occ <- ggplot(canids, aes( x = fct_reorder(species, minage, .desc = T), maxage, colour = genus))
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(species, minage, .desc = T), maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c(0, 10, 20, 30, 40, 50)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
library(ggplot2)
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv",header = F, as.is = T)
names(proboscidea) <- c("genus", "species", "minage","maxage")
head(proboscidea)
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage)) +theme(legend.position="none")+ coord_flip() +  theme(axis.text.y  = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c(0, 10, 20, 30, 40, 50)) + labs(title = "Canid Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ <- ggplot(proboscidea, aes(s = species, maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage)) +theme(legend.position="none")+ coord_flip() +  theme(axis.text.y  = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c(0, 10, 20, 30, 40, 50)) + labs(title = "Canid Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
library(forcats)
library(tidyr)
library(dplyr)
library(tidyr)
library(dplyr)
library(tidyr)
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(-age, -count) %>% mutate(diversity = cumsum(count))
ggplot(diversity, aes(x = age, y = diversity)) + geom_step()
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage)
head(diversity)
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age, -count) %>% mutate(diversity = cumsum(count))
ggplot(diversity, aes(x = age, y = diversity)) + geom_step()
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(-age, count) %>% mutate(diversity = cumsum(count))
ggplot(diversity, aes(x = age, y = diversity)) + geom_step()
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age, count) %>% mutate(diversity = cumsum(count))
ggplot(diversity, aes(x = age, y = diversity)) + geom_step()
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(-age, -count) %>% mutate(diversity = cumsum(count))
ggplot(diversity, aes(x = age, y = diversity)) + geom_step()
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(-age, count) %>% mutate(diversity = cumsum(count))
ggplot(diversity, aes(x = age, y = diversity)) + geom_step()
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(diversity, aes(x = age, y = diversity)) + geom_step()
setwd("~/Desktop/eeb-177/final_project/data_file/occurence_graph/")
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/")
proboscidea <- read.csv("~/Desktop/eeb-177/final_project/data_file/occurence_graph/manipulated_data.csv")
names(proboscidea) <- c("genus", "species", "minage","maxage")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated_data.csv")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv")
names(proboscidea) <- c("genus", "species", "minage","maxage")
head(proboscidea)
proboscidea_occ <- ggplot(proboscidea, aes(s = species, maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage))+theme(legend.position = "none")
library(tidyr)
library(dplyr)
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(diversity, aes(x = age, y = diversity)) + geom_step()
install.packages("forcats")
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c (0, 40, 80, 120, 160, 200, 240, 280, 320)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ <- ggplot(canids, aes( x = fct_reorder(species, minage, .desc = T), maxage, colour = genus))
proboscidea_occ <- ggplot(proboscidea, aes(s = species, maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage))+theme(legend.position = "none")
proboscidea_occ <- ggplot(proboscidea, aes(s = species, maxage, colour = genus))
library(ggplot)
install.packages(ggplot)
ggplot(diversity, aes(x = age, y = diversity)) + geom_step()
proboscidea_occ <- ggplot(canids, aes( x = fct_reorder(species, minage, .desc = T), maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c (0, 40, 80, 120, 160, 200, 240, 280, 320)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
library(ggplot2)
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv")
names(proboscidea) <- c("genus", "species", "minage","maxage")
head(proboscidea)
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv")
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/")
names(proboscidea) <- c("genus", "species", "minage","maxage")
head(proboscidea)
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv")
library(ggplot2)
proboscidea_occ <- ggplot(proboscidea, aes(s = species, maxage, colour = genus))
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv", header = F, as.is = T)
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv", header = F, as.is = T)
head(proboscidea)
names(proboscidea) <- c("genus", "species", "minage","maxage")
head(proboscidea)
proboscidea_occ <- ggplot(proboscidea, aes(s = species, maxage, colour = genus))
liproboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage))+theme(legend.position = "none")
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage))+theme(legend.position = "none")
library(tidyr)
library(dplyr)
library(dplyr)
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(diversity, aes(x = age, y = diversity)) + geom_step()
proboscidea_occ <- ggplot(canids, aes( x = fct_reorder(species, minage, .desc = T), maxage, colour = genus))
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(species, minage, .desc = T), maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c (0, 40, 80, 120, 160, 200, 240, 280, 320)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
library(forcats)
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(species, minage, .desc = T), maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c (0, 40, 80, 120, 160, 200, 240, 280, 320)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=7)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c (0, 40, 80, 120, 160, 200, 240, 280, 320)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c (0, 40, 80, 120, 160, 200, 240, 280, 320)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(species, minage, .desc = T), maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c (0, 40, 80, 120, 160, 200, 240, 280, 320)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 100), expand = c(0, 0), breaks=c (0, 40, 80, 120, 160, 200, 240, 280, 320)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 100), expand = c(0, 0), breaks=c (0, 40, 80, 120, 160, 200, 240, 280, 320)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(species, minage, .desc = T), maxage, colour = genus))
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(species, minage, .desc = T), maxage, colour = genus))
library(forcats)
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(species, maxage, .desc = T), minage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c (0, 40, 80, 120, 160, 200, 240, 280, 320)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(species, minage, .desc = T), maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c (0, 40, 80, 120, 160, 200, 240, 280, 320)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(genus, minage, .desc = T), maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c (0, 40, 80, 120, 160, 200, 240, 280, 320)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c (0, 40, 80, 120, 160, 200, 240, 280, 320)) + labs(title = "Proboscidea Fossil Occurrences", x = "Genus", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
downloadPBDB(proboscidea)
devtools::install_github("paleobiodb/paleobiodb_utilities",subdir="velociraptr")
downloadPBDB(proboscidea)
install.packages(rgdal)
install.packages(PBDB)
cleanTaxonomy(proboscidea)
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv", header = F, as.is = T)
head(proboscidea)
names(proboscidea) <- c("genus", "species", "minage","maxage")
head(proboscidea)
proboscidea_occ <- ggplot(proboscidea, aes(s = species, maxage, colour = genus))
library(ggplot2)
proboscidea_occ <- ggplot(proboscidea, aes(s = species, maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage))+theme(legend.position = "none")
library(tidyr)
library(dplyr)
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(diversity, aes(x = age, y = diversity)) + geom_step()
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(-age,count) %>% mutate(diversity = cumsum(count))
ggplot(diversity, aes(x = age, y = diversity)) + geom_step()
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(diversity, aes(x = age, y = diversity)) + geom_step()
library(forcats)
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(species, minage, .desc = T), maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 320), expand = c(0, 0), breaks=c (0, 40, 80, 120, 160, 200, 240, 280, 320)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=5)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
ggplot(title = "dd", diversity, aes(x = age, y = diversity)) + geom_step()
library(ggplot2)
library(ggplot2)
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv", header = F, as.is = T)
names(proboscidea) <- c("genus", "species", "minage","maxage")
head(proboscidea)
library(tidyr)
library(dplyr)
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(title = "dd", diversity, aes(x = age, y = diversity)) + geom_step()
ggplot( diversity, aes(x = age, y = diversity)) + geom_step() + labs(title = "dd")
ggplot( diversity, aes(x = age, y = diversity)) + geom_step() + labs(title = "Diversity through Time")
ggplot( diversity, aes(x = age, y = diversity)) + geom_step() + labs(title = "Diversity through Time")+theme(axis.title =element_text(size=20))
ggplot( diversity, aes(x = age, y = diversity)) + geom_step() + labs(title = "Diversity through Time")+ttheme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
ggplot( diversity, aes(x = age, y = diversity)) + geom_step() + labs(title = "Diversity through Time")+ theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
library(ggplot2)
library(ggplot2)
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv", header = F, as.is = T)
names(proboscidea) <- c("genus", "species", "minage","maxage")
head(proboscidea)
```{r}
library(ggplot2)
library(ggplot2)
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv", header = F, as.is = T)
names(proboscidea) <- c("genus", "species", "minage","maxage")
head(proboscidea)
```{r}
library(tidyr)
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
library(tidyr)
library(dplyr)
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot( diversity, aes(x = age, y = diversity)) + geom_step() + labs(title = "Diversity through Time")+ theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
library(forcats)
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(species, minage, .desc = T), maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(species, minage, .desc = T), minage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(species, maxage, .desc = T), maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
library(ggplot2)
library(ggplot2)
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv", header = F, as.is = T)
library(tidyr)
library(dplyr)
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot( diversity, aes(x = age, y = diversity)) + geom_step() + labs(title = "Diversity through Time")+ theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv", header = F, as.is = T)
names(proboscidea) <- c("genus", "species", "minage","maxage")
head(proboscidea)
```{r}
library(dplyr)
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot( diversity, aes(x = age, y = diversity)) + geom_step() + labs(title = "Diversity through Time")+ theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
library(forcats)
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(species, maxage, .desc = T), maxage, colour = genus))
proboscidea_occ <- ggplot(proboscidea, aes( x = log(fct_reorder(species, maxage, .desc = T)), maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(species, maxage, .desc = T), maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = log"Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20)) + y = log(Ma ago)
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5, log = True)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5, log = T)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(species, maxage, .desc = T), maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5, log = T)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20)) + scale_y_log10()
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
```{r}
ry(forcats)
library(forcats)
proboscidea_occ <- ggplot(proboscidea, aes( x = fct_reorder(species, maxage, .desc = T), maxage, colour = genus))
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + scale_y_continuous(limits=c(0, 60), expand = c(0, 0), breaks=c (0, 10, 20, 30, 40, 50, 60)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20)) + scale_y_log10()
proboscidea_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=4)) + labs(title = "Proboscidea Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20)) + scale_y_log10()
install.packages(c("geoscale","strap"),dependencies = TRUE)
library(strap)
timetree <- bin_timePaleoPhy(tree = retioTree, timeList = retioRanges, type = "basic", ntrees = 1, plot = TRUE)
install.packages("paleotree")
install.packages("paleotree")
timetree <- bin_ti
str(proboscidea)
proboscidea[[1]]
proboscidea[[2]]
proboscidea[[3]]
timetree <- bin_timePaleoPhy(tree = retioTree, timeList = proboscidea, type = "basic", ntrees = 1, plot = TRUE)
library(bin_timePaleoPhy)
install.packages("bin_timePaleoPhy")
library(ggplot2)
library(ggplot2)
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv", header = F, as.is = T)
names(proboscidea) <- c("genus", "species", "minage","maxage")
head(proboscidea)
library(tidyr)
library(dplyr)
diversity <- proboscidea %>% gather(key = genus, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
diversity <- proboscidea %>% gather(key = tyoe, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot( diversity, aes(x = age, y = diversity)) + geom_step() + labs(title = "Diversity through Time")+ theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(genus) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(genus) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
diversity <- proboscidea %>% gather(key = type, value = genus, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(genus) %>% summarise(count = sum(count))  %>% arrange(genus,count) %>% mutate(diversity = cumsum(count))
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot( diversity, aes(x = age, y = diversity)) + geom_step() + labs(title = "Diversity through Time")+ theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
counts <- proboscidea %>%
group_by(age, genus) %>%
summarise(count=n())
ggplot(counts, aes(x=age, y=count, group=genus)) +
geom_line()
counts <- proboscidea %>% group_by(age, genus) %>% summarise(count=n())
counts <- proboscidea%>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age, genus) %>% summarise(count=n())
counts <- proboscidea%>%gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age, genus) %>% summarise(count=n())
ggplot(counts, aes(x=age, y=count, group=genus)) +
geom_line()
ggplot(counts, aes(x=age, y=count, color=genus)) +
geom_line()
counts <- proboscidea%>%gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age, genus) %>% summarise(count=sum(count))
ggplot(counts, aes(x=age, y=count, color=genus)) +
geom_line()
counts <- proboscidea%>%gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, 0)) %>% group_by(age, genus) %>% summarise(count=sum(count))
ggplot(counts, aes(x=age, y=count, color=genus)) +
geom_line()
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/location/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/location/location.csv", header = T, as.is = T)
head(proboscidea)
library(tidyr)
library(dplyr)
counts <- proboscidea%>%gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, 0)) %>% group_by(age, genus) %>% summarise(count=sum(count))
library(dplyr)
counts <- proboscidea%>%gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "max_age", 1, 0)) %>% group_by(age, family) %>% summarise(count=sum(count))
ggplot(counts, aes(x=age, y=count, color=family)) +
geom_line()
yearly_counts <- proboscidea %>%
group_by(max_age, family) %>%
summarise(count=n())
library(dplyr)
library(tidyr)
library(dplyr)
yearly_counts <- proboscidea %>%
group_by(max_age, family) %>%
summarise(count=n())
library(ggplot2)
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/location/location.csv", header = T, as.is = T)
head(proboscidea)
yearly_counts <- proboscidea %>%
group_by(max_ma, family) %>%
summarise(count=n())
counts <- proboscidea %>%
group_by(max_ma, family) %>%
summarise(count=n())
ggplot(counts, aes(x=age, y=count, group=family)) +
geom_line()
ggplot(counts, aes(x=max_ma, y=count, group=family)) +
geom_line()
ggplot(counts, aes(x=max_ma, y=count, group=family, colour = family)) +
geom_line()
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
library(ggplot2)
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/occurence_graph/manipulated-data.csv", header = F, as.is = T)
names(proboscidea) <- c("genus", "species", "minage","maxage")
head(proboscidea)
library(tidyr)
library(dplyr)
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot( diversity, aes(x = age, y = diversity, group = genus)) + geom_step() + labs(title = "Diversity through Time")+ theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
ggplot( diversity, aes(x = age, y = diversity, color = genus)) + geom_step() + labs(title = "Diversity through Time")+ theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
ggplot( diversity, aes(x = age, y = diversity, colour = genus)) + geom_step() + labs(title = "Diversity through Time")+ theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age,genus) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot( diversity, aes(x = age, y = diversity, colour = genus)) + geom_step() + labs(title = "Diversity through Time")+ theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
ggplot( diversity, aes(x = age, y = diversity)) + geom_step() + labs(title = "Diversity through Time")+ theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
diversity <- proboscidea %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot( diversity, aes(x = age, y = diversity)) + geom_step() + labs(title = "Diversity through Time")+ theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
counts <- proboscidea %>%
group_by(max_ma, family) %>%
summarise(count=sum(count))
ggplot(counts, aes(x=max_ma, y=count, group=family, colour = family)) +
geom_line()
counts <- proboscidea %>%
group_by(max_ma, family) %>%
summarise(count=sum(count))%>% mutate(counts = cumsum(count))
ggplot(counts, aes(x=max_ma, y=count, group=family, colour = family)) +
geom_line()
counts <- proboscidea %>%
group_by(max_ma, family) %>%
summarise(count=sum(count))%>% mutate(counts = cumsum(count))
counts <- proboscidea %>%
group_by(max_ma) %>%
summarise(count=sum(count))%>% mutate(counts = cumsum(count))
counts <- proboscidea %>%
group_by(max_ma,family) %>%
summarise(count=n())%>% mutate(counts = cumsum(count))
counts <- proboscidea %>%
group_by(max_ma,family) %>%
summarise(count=n())
library(tidyr)
library(dplyr)
counts <- proboscidea %>%
group_by(max_ma,family) %>%
summarise(count=n())
counts <- proboscidea %>% group_by(max_ma,family) %>%summarise(count=n())
library(ggplot2)
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/location/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/location/location.csv", header = T, as.is = T)
head(proboscidea)
library(dplyr)
counts <- proboscidea %>% group_by(max_ma,family) %>%summarise(count=n())
ggplot(counts, aes(x=max_ma, y=count, group=family, colour = family)) +
geom_line()
counts <- proboscidea %>% group_by(max_ma,family) %>%summarise(count=sum(count))
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/location/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/location/location.csv", header = T, as.is = T)
head(proboscidea)
counts <- proboscidea %>% group_by(max_ma,family) %>%summarise(count=sum(count))%>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=max_ma, y=count, group=family, colour = family)) +
geom_line()
counts <- proboscidea %>%  gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>%group_by(max_ma,family) %>%summarise(count=sum(count))%>% mutate(diversity = cumsum(count))
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>%group_by(max_ma,family) %>%summarise(count=sum(count))%>% mutate(diversity = cumsum(count))
library(ggplot2)
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/location/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/location/location.csv", header = T, as.is = T)
head(proboscidea)
```{r}
map_data <-
base_world_messy1 + geom_point(data=proboscidea,aes(x=lng, y=lat), colour="Blue",pch=2, size=0.1, alpha=I(1)) + labs(title = "Fossil Records on World Map", x = "Longitude", y = "Latitude") + theme(plot.title = element_text(hjust = 0.5, size=18, face = "bold"), axis.title =element_text(size=10))
map_data
library(maps)
library(ggplot2)
world_map <- map_data("world")
p <- ggplot() + coord_fixed() +
xlab("") + ylab("")
base_world_messy <- p + geom_polygon(data=world_map, aes(x=long, y=lat, group=group),
colour="black ", fill="black")
base_world_messy
p <- ggplot() + coord_fixed() +
xlab("") + ylab("")
base_world_messy1 <- p + geom_polygon(data=world_map, aes(x=long, y=lat, group=group),
colour="light green ", fill="light green")
base_world_messy1
library(ggplot2)
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/location/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/location/location.csv", header = T, as.is = T)
head(proboscidea)
map_data <-
base_world_messy1 + geom_point(data=proboscidea,aes(x=lng, y=lat), colour="Blue",pch=2, size=0.1, alpha=I(1)) + labs(title = "Fossil Records on World Map", x = "Longitude", y = "Latitude") + theme(plot.title = element_text(hjust = 0.5, size=18, face = "bold"), axis.title =element_text(size=10))
map_data <-
base_world_messy1 + geom_point(data=proboscidea,aes(x=lng, y=lat), colour="Blue",pch=2, size=0.1, alpha=I(1)) + labs(title = "Fossil Records on World Map", x = "Longitude", y = "Latitude") + theme(plot.title = element_text(hjust = 0.5, size=18, face = "bold"), axis.title =element_text(size=10))
map_data
map_data <-
base_world_messy1 + geom_point(data=proboscidea,aes(x=lng, y=lat, colour=accepted_rank),pch=2, size=0.1, alpha=I(1)) + labs(title = "Fossil Records according to Rank", x = "Longitude", y = "Latitude") + theme(plot.title = element_text(hjust = 0.5, size=18, face = "bold"), axis.title =element_text(size=10))
map_data
library(RColorBrewer)
myPalette <- colorRampPalette(rev(brewer.pal(11, "Spectral")))
sc <- scale_colour_gradientn(colours = myPalette(100), limits=c(0, 50))
map_data <-
base_world_messy + geom_point(data=proboscidea,aes(x=lng, y=lat, colour=max_ma),pch=2, size=0.2, alpha=I(1)) + labs(title = "Fossil Records according to Time", x = "Longitude", y = "Latitude") + theme(plot.title = element_text(hjust = 0.5, size=18, face = "bold"), axis.title =element_text(size=10)) + sc
map_data
map_data <-
base_world_messy1 + geom_point(data=proboscidea,aes(x=lng, y=lat, colour=family),pch=2, size=0.1, alpha=I(1)) + labs(title = "Fossil Records according to Family", x = "Longitude", y = "Latitude") + theme(plot.title = element_text(hjust = 0.5, size=18, face = "bold"), axis.title =element_text(size=10))
map_data
library(tidyr)
library(dplyr)
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>%group_by(max_ma,family) %>%summarise(count=sum(count))%>% mutate(diversity = cumsum(count))
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>%group_by(max_ma,family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
library(ggplot2)
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/location/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/location/location.csv", header = T, as.is = T)
head(proboscidea)
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "max_ma", 1, -1)) %>%group_by(max_ma,family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=max_ma, y=count, group=family, colour = family)) +
geom_line()
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "max_ma", 1, -1)) %>%group_by(age,family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=max_ma, y=count, group=family, colour = family)) +
geom_line()
ggplot(counts, aes(x=age, y=count, group=family, colour = family)) +
geom_line()
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "max_ma", 1, 0) %>%group_by(age,family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=age, y=count, group=family, colour = family)) +
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "max_ma", 1, 0)) %>%group_by(age,family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=age, y=count, group=family, colour = family)) +
geom_line()
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "max_ma", 1, 0)) %>%group_by(age) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=age, y=count, group=family, colour = family)) +
geom_line()
ggplot(counts, aes(x=age, y=count, colour = family)) +
geom_line()
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "max_ma", 1, 0)) %>%group_by(age) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=age, y=count, colour = family)) +
geom_line()
ggplot(counts, aes(x=age, y=count, colour = family)) +
geom_line()
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "max_ma", 1, 0)) %>%group_by(age, family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=age, y=count, colour = family)) +
geom_line()
ggplot(counts, aes(x=age, y=count, group = family)) +
geom_line()
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "max_ma", 1, 0)) %>%group_by(age, family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=age, y=count, group = family)) +
geom_line()
ggplot(counts, aes(x=age, y=count, color = family)) +
geom_line()
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "max_ma", 1, -1)) %>%group_by(age, family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=age, y=count, color = family)) +
geom_line()
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "max_ma")) %>%group_by(age, family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>%group_by(age, family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "maxage", 1, -1))%>%group_by(age, family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=age, y=count, color = family)) +
geom_line()
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "max_ma", 1, -1))%>%group_by(age, family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=age, y=count, color = family)) +
geom_line()
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "maxage", 1, -1))%>%group_by(age, family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "maxage", 1, 0))%>%group_by(age, family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=age, y=count, color = family)) +
geom_line()
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "maxage", 1, -1))%>%group_by(age, family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=age, y=count, color = family)) +
geom_line()
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "maxage", -1, 1))%>%group_by(age, family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=age, y=count, color = family)) +
geom_line()
proboscidea %>%
group_by(family, max_ma) %>%
tally %>%
ggplot(aes(x = max_ma, y = count, group = family, color = family)) +
geom_line()
proboscidea %>% group_by(family, max_ma) %>% tally %>% ggplot(aes(x = max_ma, y = count, group = family, color = family)) +
geom_line()
library(tidyr)
library(dplyr)
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "maxage", -1, 1))%>%group_by(age, family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
library(ggplot2)
setwd("~/Desktop/eeb-177/eeb-177-final-project/data_file/location/")
proboscidea <- read.csv("~/Desktop/eeb-177/eeb-177-final-project/data_file/location/location.csv", header = T, as.is = T)
head(proboscidea)
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "maxage", -1, 1))%>%group_by(age, family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=age, y=count, color = family)) +
geom_line()
proboscidea %>% group_by(family, max_ma) %>% tally %>% ggplot(aes(x = max_ma, y = count, group = family, color = family)) +
geom_line()
proboscidea %>%
group_by(family, max_ma) %>% tally %>% ggplot(aes(x = max_ma, y = count, group = family, color = family)) +
geom_line()
proboscidea %>%
group_by(family, age) %>% tally %>% ggplot(aes(x = age, y = count, group = family, color = family)) +
geom_line()
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "max_ma", 1, -1))%>%group_by(age, family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=age, y=count, color = family)) +
geom_line()
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "maxage", 1, -1))%>%group_by(age, family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=age, y=count, color = family)) +
geom_line()
counts <- proboscidea %>%  gather(key = type, value = age, min_ma, max_ma) %>% mutate(count = ifelse(type == "maxage", -1, 1))%>%group_by(age, family) %>%summarise(count=sum(count))%>% arrange(age,count) %>% mutate(diversity = cumsum(count))
ggplot(counts, aes(x=age, y=count, color = family)) +
geom_line()
