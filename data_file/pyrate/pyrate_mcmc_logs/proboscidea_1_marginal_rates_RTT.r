# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/eeb-177-final-project/data_file/pyrate/pyrate_mcmc_logs/proboscidea_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/eeb-177-final-project/data_file/pyrate/pyrate_mcmc_logs/proboscidea_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.0878062104961, 0.0878062104961,0.0887105854142,0.0785622420103,0.0595934750238,0.0664598289409,0.0686460971836,0.0686460971836,0.0686460971836,0.068608143376,0.0698272192884,0.068608143376,0.068608143376,0.0698272192884,0.0686460971836,0.0678414615827,0.0613116380095,0.0713351372353,0.0710817389502,0.0713351372353,0.0803277115847,0.102044623286,0.122871857045,0.126248062227,0.123529692868,0.124268063464,0.125065997968,0.124177548167,0.124960061678,0.126654215184,0.124177548167,0.124268063464,0.124177548167,0.123591619752,0.123591619752,0.124177548167,0.123499362501,0.123591619752,0.12039260949,0.110240196149,0.124666519366,0.12720591456,0.124370577424,0.121493619271,0.1272332776,0.12720591456,0.126654215184,0.124728777981,0.125516450561,0.12720591456,0.1268263225,0.125516450561,0.123876067755,0.125516450561,0.124960061678,0.123876067755)
L_hpd_M95=c(0.255245540418, 0.255245540418,0.257011577115,0.251684829006,0.166000698371,0.140412038766,0.137744379656,0.1365101451,0.136225809426,0.136151014062,0.137286288808,0.135752798139,0.135694437451,0.137277927101,0.136410776316,0.137277927101,0.181054197642,0.214669547368,0.22168889524,0.249693722168,0.290975939367,0.311694801393,0.318197963422,0.318197963422,0.31416032038,0.31378315817,0.313319339741,0.311221896334,0.311221896334,0.312707236301,0.310011681112,0.310066004606,0.310253550394,0.310066004606,0.311179984956,0.312539217875,0.31416032038,0.318978079384,0.331006501998,0.3896772329,0.470823830036,0.50636421782,0.518686056479,0.52117329211,0.532643375711,0.535024477722,0.541648843838,0.553684832779,0.56238369558,0.580862342751,0.589741654651,0.595960067272,0.598182293247,0.603594328614,0.604488512477,0.603770247185)
M_hpd_m95=c(1.04026501828, 1.04026501828,0.0623875771664,0.0609353742149,0.0620836949498,0.0615244502803,0.0609353742149,0.0620836949498,0.0480757955806,0.0437970738802,0.0422969418395,0.0191038214966,0.0131772938071,0.0111710491677,0.00886197438781,0.00819526505518,0.0079515881675,0.00515259661742,2.275185238e-05,2.275185238e-05,2.275185238e-05,2.275185238e-05,2.275185238e-05,0.0197214306625,0.025627713873,0.0321876304687,0.0343875190987,0.0444748399627,0.0769050455627,0.0858766695085,0.0842418630864,0.0769050455627,0.0688860659358,0.0686440698035,0.0688860659358,0.0658152433555,0.065505080066,0.0643677053738,0.0658440593349,0.0676447764166,0.0603490435532,0.0575783528861,0.0461232918263,0.0472262645602,0.0554524139375,0.0596404272383,0.0661906329062,0.0570743326343,0.0661906329062,0.0751423655474,0.0661906329062,0.0665981347888,0.0661906329062,0.0743904955963,0.0697227769355,0.0697227769355)
M_hpd_M95=c(1.75371308337, 1.75371308337,0.134475950901,0.132783643348,0.133732321433,0.133339827101,0.132783643348,0.135124246945,0.131127800266,0.128592747313,0.128273269119,0.120321357342,0.106155110703,0.0979225045294,0.0841904535104,0.0784334308533,0.0767983219317,0.0717005099767,0.0656973644033,0.0657604770163,0.0675332351317,0.0807467886997,0.186803918835,0.236613314634,0.238875116188,0.244381007912,0.246647231204,0.25598683818,0.28044299642,0.267935082477,0.264028289874,0.25598683818,0.245753731518,0.239649055514,0.238170387269,0.233666886039,0.232841438025,0.232841438025,0.236056486731,0.241318282701,0.256990251271,0.289381355075,0.301462855448,0.326851650147,0.35836943803,0.38548040352,0.405768338694,0.467126277817,0.568998332861,0.676041481441,0.699802595291,0.741091522271,0.7729463001,0.795529079738,0.795529079738,0.795529079738)
R_hpd_m95=c(-1.64085257197, -1.64085257197,-0.0251363249366,-0.0362950387754,-0.0541512656465,-0.0486412961573,-0.0465374063754,-0.0460890394308,-0.0412109708308,-0.0412026227169,-0.0411628649241,-0.0332487031472,-0.0179637687962,-0.00755920652035,0.0081498050504,0.0135148266336,0.00807968139254,0.0227012249364,0.0226489852716,0.0247689318567,0.0425775945296,0.0623002998723,0.0117729686373,-0.0496391600559,-0.0579013753917,-0.0524555060354,-0.0585972446259,-0.0587092214465,-0.067600053789,-0.0730164469547,-0.0652203166589,-0.0608605273946,-0.0585972446259,-0.0567538852867,-0.0563310858256,-0.0568386090226,-0.0578216865628,-0.0578216865628,-0.0619438860008,-0.0749814969049,-0.0714295577077,-0.0878206167538,-0.121853652238,-0.140211418955,-0.154630685754,-0.186445506602,-0.195034740533,-0.257283418227,-0.342763169983,-0.454123443038,-0.483730472095,-0.545238385157,-0.573558457965,-0.594001628215,-0.600379053328,-0.600379053328)
R_hpd_M95=c(-0.892362411728, -0.892362411728,0.170851566563,0.159012009656,0.0776411892941,0.057138750836,0.0553087210062,0.0552935384122,0.0642420994186,0.0652448858487,0.0661268581994,0.094801106678,0.107204595822,0.111439675094,0.11362142481,0.116746813273,0.157292287505,0.189221502732,0.197107769771,0.227012178089,0.272205014634,0.293755911933,0.303793132348,0.24148450779,0.225361894995,0.223874267304,0.209086270328,0.206562403943,0.193830405404,0.18553343976,0.188679776041,0.191429397443,0.188922793651,0.188922793651,0.190967918194,0.192080257368,0.193710554157,0.199654056175,0.211064002901,0.261939636716,0.359821051586,0.418726365124,0.414923853613,0.418726365124,0.42955010785,0.418726365124,0.432164089917,0.46705051876,0.477709695902,0.477709695902,0.474784883178,0.465058265239,0.475743065408,0.475743065408,0.477709695902,0.477709695902)
L_mean=c(0.150569957886, 0.150569957886,0.150882151691,0.140562654741,0.109950309726,0.104879766713,0.10358769925,0.103257403462,0.103164628529,0.10318716715,0.103231459795,0.103368298811,0.103597251662,0.103865835356,0.10396767965,0.104514320477,0.11168441586,0.119668686808,0.12318265772,0.139907236601,0.188154344605,0.223586850535,0.231107589699,0.232045221537,0.232083672216,0.232133981072,0.232330919877,0.231842149213,0.23128025699,0.230928696544,0.229817821319,0.229162778873,0.228619719436,0.228188912929,0.227847397207,0.227518020474,0.227922821726,0.229373401819,0.233549131363,0.247337918307,0.265396912967,0.277492837816,0.282645727911,0.285067799695,0.287119333287,0.288559598663,0.291339209096,0.296204067487,0.29974104053,0.304397215648,0.307833591507,0.311215888513,0.313571211504,0.315081281994,0.315429552622,0.315523419512)
M_mean=c(1.3935773824, 1.3935773824,0.0978675076253,0.0976740558486,0.0976198145077,0.0976449320743,0.0976217643166,0.0971261936318,0.092805123129,0.091705228091,0.0911192980071,0.0770008740213,0.0550166963893,0.0457280854814,0.0370591390965,0.0348697061803,0.0343360241502,0.0314599185085,0.0311469718824,0.031192040872,0.0316335598632,0.0356867830904,0.0699604999279,0.143043181715,0.147570026254,0.151579699022,0.158321201006,0.161884097432,0.166688917263,0.171961593659,0.169361157241,0.165644512136,0.159097268041,0.155297530848,0.153622843188,0.152731522139,0.152337677567,0.152042997433,0.1524226194,0.154397130038,0.160550173987,0.167053443405,0.170391934414,0.174155786951,0.178853304298,0.183935277727,0.187940678848,0.203307993106,0.227400350106,0.260564876999,0.274374135905,0.29605484391,0.311053013033,0.318223277895,0.320288001773,0.320519248922)
R_mean=c(-1.24300742452, -1.24300742452,0.0530146440662,0.0428885988928,0.0123304952186,0.00723483463886,0.00596593493382,0.00613120983055,0.0103595054002,0.0114819390592,0.0121121617874,0.0263674247902,0.0485805552725,0.0581377498745,0.0669085405531,0.0696446142972,0.0773483917102,0.0882087682993,0.0920356858378,0.108715195729,0.156520784742,0.187900067445,0.161147089771,0.0890020398217,0.0845136459621,0.0805542820503,0.0740097188708,0.0699580517811,0.0645913397271,0.0589671028845,0.0604566640774,0.0635182667363,0.0695224513953,0.0728913820812,0.0742245540183,0.0747864983349,0.0755851441594,0.0773304043857,0.0811265119629,0.0929407882697,0.10484673898,0.110439394411,0.112253793497,0.110912012744,0.108266028989,0.104624320936,0.103398530248,0.0928960743814,0.0723406904241,0.0438323386492,0.0334594556017,0.015161044603,0.0025181984708,-0.00314199590114,-0.00485844915088,-0.00499582941041)
trans=0.5
age=(0:(56-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.664937363725), xlim = c(-58.8,2.8), ylab = 'Speciation rate', xlab = 'Ma',main='proboscidea' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.9290843917), xlim = c(-58.8,2.8), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.80493782917, 0.525480665492), xlim = c(-58.8,2.8), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-58.8,2.8), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()